# OrderEngine 服务器配置文件

# 服务器配置
[server]
ip = 0.0.0.0
port = 8080
thread_num = 8
max_connections = 10000
keepalive_timeout = 300
read_timeout = 30
write_timeout = 30

# 数据库配置
[database]
host = localhost
port = 3306
username = orderuser
password = orderpass
database = order_engine
charset = utf8mb4
max_connections = 50
min_connections = 10
connection_timeout = 5
query_timeout = 30
auto_reconnect = true

# Redis配置
[redis]
# 主节点
master_host = localhost
master_port = 6379
master_password = 
master_database = 0

# 从节点（可选）
slave_host = localhost
slave_port = 6380
slave_password = 
slave_database = 0

# 连接池配置
max_connections = 20
min_connections = 5
connection_timeout = 3000
socket_timeout = 3000
max_retries = 3

# Kafka配置
[kafka]
brokers = localhost:9092
client_id = order_engine_producer
compression_type = snappy
batch_size = 16384
linger_ms = 5
retries = 3
request_timeout_ms = 30000
max_in_flight_requests = 5

# 主题配置
order_events_topic = order_events
inventory_events_topic = inventory_events
payment_events_topic = payment_events

# 日志配置
[logging]
level = info
max_file_size = 100MB
max_files = 10
log_dir = ./logs
console_output = true

# 性能调优
[performance]
# 网络相关
tcp_nodelay = true
tcp_keepalive = true
so_reuseport = true
epoll_timeout = 1000

# 内存相关
initial_buffer_size = 4096
max_buffer_size = 1048576
memory_pool_size = 100MB

# 线程相关
cpu_affinity = true
thread_stack_size = 8MB

# 业务配置
[business]
# 订单相关
max_products_per_order = 50
max_order_amount = 100000.00
order_timeout = 1800
inventory_reserve_timeout = 300

# 库存相关
stock_check_enabled = true
oversell_protection = true
stock_sync_interval = 60

# 缓存相关
[cache]
# L1缓存（内存）
l1_cache_size = 100MB
l1_cache_ttl = 300

# L2缓存（本地Redis）
l2_cache_ttl = 3600
l2_cache_enabled = true

# L3缓存（远程Redis集群）
l3_cache_ttl = 7200
l3_cache_enabled = true

# 缓存策略
cache_aside_enabled = true
write_through_enabled = false
write_behind_enabled = false

# 监控配置
[monitoring]
metrics_enabled = true
metrics_port = 9100
health_check_enabled = true
health_check_port = 8081

# Prometheus指标
prometheus_enabled = true
prometheus_endpoint = /metrics

# 链路追踪
tracing_enabled = true
jaeger_endpoint = http://localhost:14268/api/traces
sampling_rate = 0.1

# 安全配置
[security]
# JWT配置
jwt_secret = your_jwt_secret_key_here
jwt_expire_time = 3600
jwt_refresh_time = 86400

# 限流配置
rate_limit_enabled = true
rate_limit_qps = 1000
rate_limit_burst = 2000

# IP白名单（可选）
# ip_whitelist = 127.0.0.1,192.168.1.0/24
